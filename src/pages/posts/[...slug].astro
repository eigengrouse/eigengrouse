---
import PostLayout from '../../layouts/PostLayout.astro';
import { type CollectionEntry, getCollection, render } from 'astro:content';

export async function getStaticPaths() {
	const posts = await getCollection('posts');
	return posts.map((post, index) => ({
		params: { slug: post.id },
		props: {
      post,
      prevPost: index < posts.length - 1 ? posts[index + 1] : null,
      nextPost: index > 0 ? posts[index - 1] : null,
    },
	}));
}
type Props = CollectionEntry<'posts'>;

const { post, prevPost, nextPost } = Astro.props;
const { Content } = await render(post);
const base = import.meta.env.BASE_URL.endsWith('/') ? import.meta.env.BASE_URL : import.meta.env.BASE_URL + '/';
---

<PostLayout {...post.data}>
  <Content />
  
  <div class="pagination">
    <div class="pagination__title">
      <span class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      {prevPost && (
        <>
          <a href={`${base}posts/${prevPost.id}/`} class="button inline prev">
            &lt; [<span class="button__text">{prevPost.data.title}</span>]
          </a>
          {prevPost && nextPost && <span>::</span>}
        </>
      )}
      {nextPost && (
        <a href={`${base}posts/${nextPost.id}/`} class="button inline next">
          [<span class="button__text">{nextPost.data.title}</span>] &gt;
        </a>
      )}
    </div>
  </div>
</PostLayout>